## chapter 02

+ cpu 术语概念
    1. 内存屏障：一组处理器指令，对内存操作的顺序限制
    2. 缓存行：存缓中可以分配的最小内存
    3. 原子操作
    4. 缓存行填充：当处理器觉得从内存中读取操作是可缓存的，处理器读取缓存行到适当的缓存
    5. 缓存命中：从内存读取=>从缓存读取
    6. 写命中：就是磁盘或者内存上的存储区域之前有没有写过数据。如果有，这次再写到相同的区域叫写命中；如果写到其他区域，叫写未命中
    7. 写缺失：缓存行写到了不存在的内存区域

+ volatile
  拿 i++ 举例，有三个步骤：①取出 i ② i + 1 ③写入 i
  1. 一般情况下，第③步的写入是写到缓存行中的，但加上 volatile 后，它会无视缓存，将 i 存到内存中
  2. 存缓过期后，处理器会更新存缓，让其它 cpu 也能拿到最新的 i
  
+ synchronized 锁对象的三种形式
  1. 普通方法：当前实例对象
  2. 静态方法：当前当前类的 class 对象
  3. 方法块：synchronized 括号里配置的对象
  
+ Java 对象头
  1. 包括 Mark Word、Class Metadata Address 和 Array length
  2. Mark Word 的最后两位标志位表示锁的状态
  
+ 偏向锁
  1. 适用于只有一个线程访问同步块场景
  2. 关闭偏向锁 `-XX:-UseBiasedLocking=false`

+ 轻量级锁 重量级锁
  1. 有两个线程 A 和 B，同时竞争一个资源 c
  2. A 拿到轻量级锁，B 将自旋获取锁，自旋一定时间后膨胀为重量级锁（一直自旋会占用 cpu），阻塞了
  3. A 做完当前的事后想再次使用资源 c，发现 c 的 Mark Word 被 B 标记为重量级锁，便竞争不过
  4. 所以 A 释放了 c，并且 notify 其它线程，然后 B 就可以使用资源 c 了
  
+ cpu 术语概念
  1. 缓存行
  2. CAS
  3. cpu 流水线
  4. 内存顺序冲突：多个 cpu 同时修改一个缓存行的不同部分引起其中一个 cpu 的操作无效，当出现内存顺序冲突时，cpu 必须清空流水线
  
+ 原子操作原理
  1. 总线锁：处理器 A 拿出变量 i 的时候，锁上了总线，处理器 B 拿不出来 i
  2. 缓存锁：基于缓存一致性
  
+ 原子操作实现：AtomTest.java

+ 